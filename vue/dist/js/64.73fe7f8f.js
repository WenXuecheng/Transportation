"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[64],{2064:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("div",{staticStyle:{margin:"10px 0"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"按用户名搜索","suffix-icon":"el-icon-search"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"按用姓名搜索","suffix-icon":"el-icon-search"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t("el-button",{staticClass:"ml-5",attrs:{type:"primary"},on:{click:e.searchOrdersByUsername}},[e._v("搜索")]),t("el-button",{attrs:{type:"warning"},on:{click:e.reset}},[e._v("重置")]),t("el-button",{staticClass:"ml-5",attrs:{type:"primary"},on:{click:e.exp}},[e._v("导出 "),t("i",{staticClass:"el-icon-top"})])],1),t("el-table",{staticStyle:{width:"100%","border-radius":"25px"},attrs:{"header-cell-style":"background-color: #DCDFE6; color: #606266;",data:e.tableData,border:"",height:"720",width:"100%",size:"medium","default-expand-all":"ture"}},[t("el-table-column",{attrs:{type:"expand","align-center":"true"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-descriptions",{attrs:{column:"3",size:"mini",border:""}},[t("template",{slot:"extra"},[t("el-button",{directives:[{name:"no-more-click-ten",rawName:"v-no-more-click-ten"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.sendmailpay(a.row)}}},[e._v("发送支付邮件")]),t("el-button",{directives:[{name:"no-more-click-ten",rawName:"v-no-more-click-ten"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.sendmail(a.row)}}},[e._v("发送邮件")]),t("el-button",{directives:[{name:"no-more-click-ten",rawName:"v-no-more-click-ten"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.editOrder(a.row)}}},[e._v("编辑订单")]),t("el-button",{directives:[{name:"no-more-click-ten",rawName:"v-no-more-click-ten"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.confirmeOrder(a.row)}}},[e._v("确认订单")]),t("el-button",{directives:[{name:"no-more-click-ten",rawName:"v-no-more-click-ten"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.showAdminPhoto(a.row.adminUpload)}}},[e._v("查看管理员上传")]),t("el-button",{directives:[{name:"no-more-click-ten",rawName:"v-no-more-click-ten"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.showUserPhoto(a.row.userUpload)}}},[e._v("查看用户上传")]),t("el-button",{directives:[{name:"no-more-click-ten",rawName:"v-no-more-click-ten"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleAddPhoto(a.row.orderName)}}},[e._v("上传照片")]),t("el-popconfirm",{staticClass:"ml-5",attrs:{"confirm-button-text":"确定","cancel-button-text":"我再想想",icon:"el-icon-info","icon-color":"red",title:"您确定批量删除这些数据吗？"},on:{confirm:function(t){return e.deleteOrder(a.row.orderName)}}},[t("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[e._v("撤销订单")])],1)],1),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-user"}),e._v(" 姓名 ")]),e._v(" "+e._s(a.row.name)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-mobile-phone"}),e._v(" 手机号 ")]),e._v(" "+e._s(a.row.phone)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-location-outline"}),e._v(" 物品数量和重量 ")]),e._v(" "+e._s(a.row.weight)+"kg，"+e._s(a.row.deliveryNum)+"个 ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-tickets"}),e._v(" 收货地址 ")]),t("el-tag",{attrs:{size:"small"}},[e._v(e._s(a.row.receiveAdress))])],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-office-building"}),e._v(" 寄货站点 ")]),e._v(" "+e._s(a.row.sendRegion)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-office-building"}),e._v(" 取货站点 ")]),e._v(" "+e._s(a.row.receiveRegion)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-tickets"}),e._v(" 邮箱 ")]),t("el-tag",{attrs:{size:"small"}},[e._v(e._s(a.row.email))])],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-office-building"}),e._v(" 物品详情 ")]),e._v(" "+e._s(a.row.details)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-office-building"}),e._v(" 备注 ")]),e._v(" "+e._s(a.row.remark)+" ")],2)],2),[t("div",{staticStyle:{"margin-top":"10px"}},[t("el-steps",{attrs:{space:200,active:a.row.orderStatus,"finish-status":"success","align-center":"true"}},[t("el-step",{attrs:{title:"订单已提交"}}),t("el-step",{attrs:{title:"订单等待付款"}}),t("el-step",{attrs:{title:"已从"+a.row.sendRegion+"发出"}}),t("el-step",{attrs:{title:"已到达"+a.row.receiveRegion}}),t("el-step",{attrs:{title:"待取件"}}),t("el-step",{attrs:{title:"已取件"}})],1)],1)]]}}])}),t("el-table-column",{attrs:{label:"用户名",prop:"username"}}),t("el-table-column",{attrs:{label:"订单号",prop:"orderName"}}),t("el-table-column",{attrs:{label:"保险",prop:"others[0]"}}),t("el-table-column",{attrs:{label:"自提",prop:"others[1]"}}),t("el-table-column",{attrs:{label:"快递类型",prop:"dateOut"}}),t("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),t("el-table-column",{attrs:{label:"订单确认",prop:"isConfirmed"}})],1),t("div",{staticStyle:{padding:"10px 0"}},[t("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[5,10,15,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"上传照片",visible:e.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[t("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{accept:"image/jpeg,image/png,image/jpg","auto-upload":!0,"file-list":e.fileList,"before-upload":e.onBeforeUploadImage,"on-success":e.uploadSuccess,"on-change":e.loadJsonFromFile,limit:e.limitnum,"on-exceed":e.exceedFile,"on-remove":e.removeFile,"on-error":e.uploadFileError,action:e.http+"://"+e.serverIp+":"+e.serverPort+"/file/upload"}},[t("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取照片")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),t("el-dialog",{attrs:{title:"我的上传",visible:e.UserDialogVisible,width:"50%"},on:{"update:visible":function(t){e.UserDialogVisible=t}}},[t("div",{staticClass:"demo-image__lazy"},e._l(e.urls,(function(e){return t("el-image",{key:e,attrs:{src:e,lazy:"","preview-src-list":""}})})),1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.UserDialogVisible=!1}}},[e._v("返 回")])],1)]),t("el-dialog",{attrs:{title:"我的上传",visible:e.AdminDialogVisible,width:"50%"},on:{"update:visible":function(t){e.AdminDialogVisible=t}}},[t("div",{staticClass:"demo-image__lazy"},e._l(e.urls,(function(e){return t("el-image",{key:e,attrs:{src:e,lazy:"","preview-src-list":""}})})),1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.AdminDialogVisible=!1}}},[e._v("返 回")])],1)]),t("el-dialog",{attrs:{title:"编辑订单",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("el-form",{attrs:{"label-width":"80px",size:"small"}},[t("el-form-item",{attrs:{label:"订单确认"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"确认订单"},model:{value:e.form.isConfirmed,callback:function(t){e.$set(e.form,"isConfirmed",t)},expression:"form.isConfirmed"}},e._l(e.options1,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"状态"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择订单状态"},model:{value:e.form.orderStatus,callback:function(t){e.$set(e.form,"orderStatus",t)},expression:"form.orderStatus"}},e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"重量(kg)"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.weight,callback:function(t){e.$set(e.form,"weight",t)},expression:"form.weight"}})],1),t("el-form-item",{attrs:{label:"邮箱"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),t("el-form-item",{attrs:{label:"电话"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("el-form-item",{attrs:{label:"常用快递地址"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.receiveAdress,callback:function(t){e.$set(e.form,"receiveAdress",t)},expression:"form.receiveAdress"}})],1),t("el-form-item",{attrs:{label:"应付卢布"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.rubs,callback:function(t){e.$set(e.form,"rubs",t)},expression:"form.rubs"}})],1),t("el-form-item",{attrs:{label:"应付人民币"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.rmb,callback:function(t){e.$set(e.form,"rmb",t)},expression:"form.rmb"}})],1),t("el-form-item",{attrs:{label:"重量"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.weight,callback:function(t){e.$set(e.form,"weight",t)},expression:"form.weight"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.updateOrder}},[e._v("确 定")])],1)],1)],1)},s=[],r=(a(7658),a(6369)),l=a(2618),o=(0,r.defineComponent)({name:"order",data(){return{tableData:[],serverIp:l.IV,serverPort:l.Zi,http:l.dJ,centerDialogVisible:!1,uploadUsername:"",uploadOrdername:"",user:"",fileList:[],currentOrdername:"",limitnum:10,UserDialogVisible:!1,urls:[],AdminDialogVisible:!1,pageNum:1,pageSize:10,total:0,username:"",name:"",options:[{value:1,label:"订单已提交",disabled:!0},{value:2,label:"订单等待付款",disabled:!0},{value:3,label:"已发出"},{value:4,label:"已到达"},{value:5,label:"待取件"},{value:6,label:"已取件"}],options1:[{value:!1,label:"否"},{value:!0,label:"是"}],editDialogVisible:!1,form:{id:null,orderName:null,isConfirmed:null,orderStatus:null,email:null,phone:null,receiveAdress:null,rmb:null,rubs:null,weight:null}}},created(){this.user=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{},this.searchOrdersByUsername()},methods:{handleAddPhoto(e){this.centerDialogVisible=!0,this.currentOrdername=e},updateData(){this.searchOrdersByUsername()},deleteOrder(e){try{this.request.delete("/order/ordername/"+e).then((e=>{"200"===e.code&&(this.$message.success("删除成功"),this.updateData())}))}catch(t){this.$message.error("删除失败")}},uploadFileError(e,t,a){this.$message.error("上传失败！")},exceedFile(e,t){this.$message.error("只能上传"+this.limitnum+"个文件")},removeFile(e,t){this.fileList=t},loadJsonFromFile(e,t){this.fileList=t},onBeforeUploadImage(e){const t="image/jpeg"===e.type||"image/jpg",a=e.size/1024/1024<5;return t||this.$message.error("上传文件只能是图片格式!"),a||this.$message.error("上传文件大小不能超过 1MB!"),t&&a},uploadSuccess(e,t,a){let i={orderName:this.currentOrdername,userName:"",url:e};try{this.request.post("/order-file",i).then((e=>{"200"===e.code&&(this.searchOrdersByUsername(),this.$message.success("上传成功"))})),this.searchOrdersByUsername()}catch(s){this.$message.error("上传失败"),this.request.delete("/file/url/"+e).then((e=>{}))}},searchOrdersByUsername(){this.request.get("/order/page",{params:{pageNum:this.pageNum,pageSize:this.pageSize,username:this.username,name:this.name}}).then((e=>{if(this.tableData=JSON.parse(JSON.stringify(e.data)),0===this.tableData.total)return;this.pageNum=this.tableData.current,this.pageSize=this.tableData.size,this.total=this.tableData.total,this.tableData=this.tableData.records;const t="userUpload",a="adminUpload";for(let i=0;i<this.tableData.length;i++)this.request.get("/order-file/ordername/"+this.tableData[i].orderName).then((e=>{if(this.tableData[i][t]=[],this.tableData[i][a]=[],null!=e.data)for(let s=0;s<e.data.length;s++)!1===e.data[s].adminUp?this.tableData[i][t].push(e.data[s].url):this.tableData[i][a].push(e.data[s].url)})),this.tableData[i].others=[this.tableData[i].others[0]+this.tableData[i].others[1],this.tableData[i].others[3]+this.tableData[i].others[4]],!0===this.tableData[i].isConfirmed?this.tableData[i].isConfirmed="是":this.tableData[i].isConfirmed="否","Moscow"===this.tableData[i].receiveRegion&&(this.tableData[i].receiveRegion="莫斯科"),"Guangdong"===this.tableData[i].receiveRegion&&(this.tableData[i].receiveRegion="广东"),"Moscow"===this.tableData[i].sendRegion&&(this.tableData[i].sendRegion="莫斯科"),"Guangdong"===this.tableData[i].sendRegion&&(this.tableData[i].sendRegion="广东"),"12-15days"===this.tableData[i].dateOut?this.tableData[i].dateOut=this.$t("time1"):"18-25days"===this.tableData[i].dateOut&&(this.tableData[i].dateOut=this.$t("time2"))}))},showUserPhoto(e){this.UserDialogVisible=!0,this.urls=e},showAdminPhoto(e){this.AdminDialogVisible=!0,this.urls=e},confirmeOrder(e){e={id:e.id,orderName:e.orderName,isConfirmed:!0},this.request.post("/order/update",e).then((e=>{"200"===e.code?(this.searchOrdersByUsername(),this.$message.success("保存成功")):this.$message.error(e.msg)})),this.request.get("/order/email/ok/"+e.id).then((e=>{"200"===e.code?this.$message.success("邮件发送成功"):this.$message.error("邮件发送失败")}))},handleSizeChange(e){this.pageSize=e,this.searchOrdersByUsername()},handleCurrentChange(e){this.pageNum=e,this.searchOrdersByUsername()},reset(){this.username="",this.name="",this.searchOrdersByUsername()},editOrder(e){this.editDialogVisible=!0,this.form.id=e.id,this.form.orderName=e.orderName,"是"===e.isConfirmed?this.form.isConfirmed=!0:this.form.isConfirmed=!1,this.form.orderStatus=e.orderStatus,this.form.email=e.email,this.form.phone=e.phone,this.form.receiveAdress=e.receiveAdress,this.form.weight=e.weight,this.form.rmb=e.rmb,this.form.rubs=e.rubs},updateOrder(){this.request.post("/order/update",this.form).then((e=>{"200"===e.code?(this.searchOrdersByUsername(),this.editDialogVisible=!1,this.$message.success("上传成功")):this.$message.error(e.msg)}))},sendmail(e){this.request.get("/order/email/"+e.id).then((e=>{"200"===e.code?this.$message.success("发送成功"):this.$message.error("操作失败")}))},sendmailpay(e){this.request.get("/order/email/pay/"+e.id).then((e=>{"200"===e.code?this.$message.success("发送成功"):this.$message.error("操作失败")}))},exp(){window.open(`${l.dJ}://${l.IV}:${l.Zi}/order/export`)}}}),n=o,m=a(1001),c=(0,m.Z)(n,i,s,!1,null,null,null),d=c.exports}}]);
//# sourceMappingURL=64.73fe7f8f.js.map